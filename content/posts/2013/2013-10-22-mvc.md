+++
date = "2013-10-22T01:15:43+00:00"
draft = false
tags = ["php", "mvc", "MVC"]
title = "じゃぁMVCは誰にどこまで任せれば良いのか？"
+++
下記はPHPに限らず、あるあるだと思います。

[いつまでPHPerはMVCを間違い続けるのか…?](http://mkkn.hatenablog.jp/entry/2013/04/13/212100)
---

とはいえ、言っている事は分かるけど、実際に処理を何処に食べさせ続けるのか？

複数のURIからのアクションが同席する今のcontrollerを肥大化させるのはナンセンス。

という訳で、

* 極力Modelに処理を寄せたり
* API経由のアクセスなどもModelとして扱う

など概念的にも分かりやすくするよう工夫はしてます。

が、今度はfatなModel悩まされてしまう。いつもコレに嵌ってしまいます。

また、複数テーブルを跨ぐトランザクションはcontrollerのメソッドに食べさせてしまう事も多いです。

まー複数テーブルを跨ぐトランザクションについては、

* プロセスを細切れにし、jobで状態と遷移を管理
* トランザクションの状態そのものをModelとして作る上げる

などで解決するかもしれませんが、、、

出来上がるfat Modelをどう解決するのか？
---

modelを継承し、適切なmodelに切り分けメソッドを分散する。

user modelを継承したadmin user modelとpublic user modelなど。

あとはconcern的な共通メソッドによるfat modelの回避。

うーーーん。。。

例えば、果たしてそれが正しいのか？見えきれていないのが実情です。
